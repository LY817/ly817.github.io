# HTTPS

超文本传输安全协议

在http协议的基础上，在tcp和http之间添加了SSL（Security Sockets Layer 安全套接层）来加密http的报文

SSL是为网络通信提供安全以及数据完整性的一种安全协议，是**操作系统对外的API**，SSL3.0后改名为TLS。采用身份验证和数据加密保证网络通信的安全和数据的完整性

## 实现原理

使用非对称加密来传递对称加密的秘钥，然后使用这个秘钥来对称加密真正传输的数据

> 因为非对称加密的性能较低，全程使用对称加密会限制传输效率

### 对称加密和非对称加密

#### 对称加密：加密和解密使用相同的密钥

对称加密算法是应用较早的加密算法，技术成熟。在对称加密算法中，数据发信方将明文（[原始数据](https://baike.baidu.com/item/%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE/10119290)）和**加密密钥**一起经过特殊**加密算法**处理后，使其变成复杂的加密密文发送出去。收信方收到密文后，若想解读原文，则需要使用加密用过的密钥及相同算法的逆算法对密文进行解密，才能使其恢复成可读明文。在对称加密算法中，**使用的密钥只有一个**，发收信双方都使用这个密钥对数据进行加密和解密，这就要求解密方事先必须知道加密密钥。

> 在大多数的对称算法中，**加密密钥和解密密钥是相同的**，所以也称这种加密算法为秘密密钥算法或单密钥算法
>
> 特点：**算法公开**、**计算量小**、**加密速度快**、**加密效率高**

#### 非对称加密：加密和解密使用不同的密钥

非对称加密算法需要两个密钥：[公开密钥](https://baike.baidu.com/item/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5/7453570)（publickey）和私有密钥（privatekey）。

公开密钥与私有密钥是**一对**，如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密；如果用私有密钥对数据进行加密，那么只有用对应的公开密钥才能解密。因为加密和解密使用的是两个不同的密钥，所以这种算法叫作非对称加密算法。

> 非对称加密算法实现机密信息交换的基本过程是：甲方生成一对[密钥](https://baike.baidu.com/item/%E5%AF%86%E9%92%A5/101144)并将其中的一把作为公用密钥向其它方公开；得到该公用密钥的乙方使用该密钥对机密信息进行加密后再发送给甲方；甲方再用自己保存的另一把专用密钥对加密后的信息进行解密
>
> 特点：算法强度复杂、安全性依赖于算法与密钥但是由于其算法复杂，而使得加密解密速度没有对称加密解密的速度快
>
> 公钥公开，且只能加密不能密文解密；私钥不公开，能对密文进行解密

**一般加密流程**

1. A要向B发送信息，A和B都要产生一对用于加密 和解密的公钥和私钥

2. A的私钥保密，A的公钥告诉B；B的私钥保密，B的公钥告诉A
3. A要给B发送信息时，A用B的公钥加密信息，因为A知道B的公钥
4. A将这个消息发给B（已经用B的公钥加密消息）
5. B收到这个消息后，B用自己的私钥解密A的消息。其他所有收到这个报文的人都无法解密，因为只有B才有B的私钥

### CA证书

## HTTPS连接创建过程

#### 客户端发送请求到服务器端

#### 服务器端返回证书（公开密钥作为证书的一部分而存在）

#### 客户端验证证书和公开密钥的有效性，并生成对称加密的密钥

客户端第三方机构验证证书如果有效，则生成共享密钥（对称加密）并使用公开密钥加密发送到服务器端

#### 服务器端使用私有密钥解密数据，并使用收到的共享密钥加密数据，发送到客户端

#### 客户端使用共享密钥解密数据